<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sendbird Chat</title>
  <script src="https://cdn.jsdelivr.net/npm/sendbird@3.0.173/dist/sendbird.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #f5f5f5;
    }
    .chat-container {
      width: 100%;
      max-width: 600px;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      background: white;
      display: flex;
      flex-direction: column;
      height: 80vh;
    }
    .chat-header {
      background: #1a1a1d;
      color: white;
      padding: 10px;
      text-align: center;
    }
    .chat-messages {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .chat-messages .message {
      padding: 10px;
      border-radius: 5px;
      background: #f0f0f0;
      max-width: 70%;
    }
    .chat-messages .message.self {
      background: #d1f1d1;
      align-self: flex-end;
    }
    .chat-footer {
      display: flex;
      gap: 10px;
      padding: 10px;
      border-top: 1px solid #ddd;
    }
    .chat-footer input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .chat-footer button {
      padding: 10px;
      background: #1a1a1d;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .chat-footer button:hover {
      background: #333;
    }
  </style>
</head>
<body>
  <div class="chat-container">
    <div class="chat-header">
      Sendbird Chat
    </div>
    <div id="messages" class="chat-messages">
      <!-- Chat messages will be displayed here -->
    </div>
    <div class="chat-footer">
      <input type="text" id="messageInput" placeholder="Type a message">
      <button id="sendBtn">Send</button>
    </div>
  </div>

  <script>
    const APP_ID = "B639F52A-FC34-42A7-9FF5-E0AD0A87990C"; // Replace with your Sendbird App ID
    const USER_ID = prompt("Enter your User ID"); // For simplicity, prompt the user for an ID
    const CHANNEL_URL = "sendbird_open_channel_65137_297409dd6a63fafa38c22b7b339feb0668e07465"; // Replace with the target channel URL

    const sb = new SendBird({ appId: APP_ID });
    let channel;

    // Connect to Sendbird
    sb.connect(USER_ID, (user, error) => {
      if (error) {
        alert("Connection failed: " + error.message);
        return;
      }
      console.log("Connected as:", user.nickname || USER_ID);

      // Join the channel
      sb.OpenChannel.getChannel(CHANNEL_URL, (openChannel, error) => {
        if (error) {
          alert("Failed to get channel: " + error.message);
          return;
        }
        channel = openChannel;
        channel.enter((response, error) => {
          if (error) {
            alert("Failed to join channel: " + error.message);
            return;
          }
          console.log("Joined channel:", CHANNEL_URL);
        });
      });
    });

    // Send a message
    document.getElementById("sendBtn").addEventListener("click", () => {
      const message = document.getElementById("messageInput").value;
      if (!message || !channel) return;

      channel.sendUserMessage(message, (userMessage, error) => {
        if (error) {
          alert("Failed to send message: " + error.message);
          return;
        }
        displayMessage(userMessage, true);
        document.getElementById("messageInput").value = "";
      });
    });

    // Display a message
    function displayMessage(message, isSelf) {
      const messageElement = document.createElement("div");
      messageElement.className = "message";
      if (isSelf) messageElement.classList.add("self");
      messageElement.textContent = message.message;
      document.getElementById("messages").appendChild(messageElement);
      document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
    }

    // Listen for incoming messages
    sb.addChannelHandler("messageHandler", new sb.ChannelHandler({
      onMessageReceived: (channel, message) => {
        if (message.channelUrl === CHANNEL_URL) {
          displayMessage(message, false);
        }
      },
    }));
  </script>
</body>
</html>
      
